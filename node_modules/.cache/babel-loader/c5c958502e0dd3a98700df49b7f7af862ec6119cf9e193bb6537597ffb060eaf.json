{"ast":null,"code":"import React,{useState,useEffect,useCallback,useMemo}from'react';import{DragDropContext,Droppable,Draggable}from'react-beautiful-dnd';import{Bar,Line}from'react-chartjs-2';import{Chart as ChartJS,CategoryScale,LinearScale,BarElement,LineElement,PointElement,Title,Tooltip,Legend}from'chart.js';// Register Chart.js components\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,BarElement,LineElement,PointElement,Title,Tooltip,Legend);// --- AHP Calculation Helper Functions ---\n/**\n * Calculates the priority vector (weights) from a pairwise comparison matrix.\n * @param {number[][]} pairwiseMatrix - The n x n matrix of pairwise comparisons.\n * @returns {number[]} An array of weights for each criterion.\n */const calculateWeights=pairwiseMatrix=>{if(!pairwiseMatrix||pairwiseMatrix.length===0){return[];}const numCriteria=pairwiseMatrix.length;const columnSums=Array(numCriteria).fill(0);// Sum each column\nfor(let j=0;j<numCriteria;j++){for(let i=0;i<numCriteria;i++){columnSums[j]+=pairwiseMatrix[i][j];}}// Normalize the matrix by dividing each element by its column sum\nconst normalizedMatrix=pairwiseMatrix.map(row=>row.slice());for(let j=0;j<numCriteria;j++){if(columnSums[j]===0)continue;for(let i=0;i<numCriteria;i++){normalizedMatrix[i][j]/=columnSums[j];}}// Calculate the average of each row to get the weights\nconst weights=Array(numCriteria).fill(0);for(let i=0;i<numCriteria;i++){weights[i]=normalizedMatrix[i].reduce((sum,val)=>sum+val,0)/numCriteria;}return weights;};/**\n * Calculates the consistency ratio (CR) to check for inconsistencies in judgments.\n * @param {number[][]} pairwiseMatrix - The n x n matrix of pairwise comparisons.\n * @param {number[]} weights - The calculated weights for each criterion.\n * @returns {{cr: number, isConsistent: boolean}} An object containing the consistency ratio and a boolean indicating if judgments are consistent.\n */const calculateConsistency=(pairwiseMatrix,weights)=>{const numCriteria=pairwiseMatrix.length;if(numCriteria<=2){return{cr:0,isConsistent:true};}const weightedSumVector=Array(numCriteria).fill(0);for(let i=0;i<numCriteria;i++){for(let j=0;j<numCriteria;j++){weightedSumVector[i]+=pairwiseMatrix[i][j]*weights[j];}}const consistencyVector=Array(numCriteria).fill(0);for(let i=0;i<numCriteria;i++){if(weights[i]!==0){consistencyVector[i]=weightedSumVector[i]/weights[i];}}const lambdaMax=consistencyVector.reduce((sum,val)=>sum+val,0)/numCriteria;const ci=(lambdaMax-numCriteria)/(numCriteria-1);// Random Index (RI) from Saaty's scale for n=1 to 10\nconst riMap=[0,0,0.58,0.9,1.12,1.24,1.32,1.41,1.45,1.49];const ri=riMap[numCriteria-1]||1.49;// Default to last value if > 10\nconst cr=ri===0?0:ci/ri;return{cr,isConsistent:cr<0.1};};/**\n * Safely evaluates a mathematical expression with a variable 'x'.\n * @param {string} expr - The mathematical expression string.\n * @param {number} x - The value to substitute for 'x'.\n * @returns {number | null} The result of the expression or null if invalid.\n */const safeEval=(expr,x)=>{try{if(/[^x\\d\\s()+\\-*/.]/.test(expr)){return null;}const func=new Function('x',`return ${expr}`);const result=func(x);return isNaN(result)?null:result;}catch(error){return null;}};/**\n * Performs linear interpolation for a value x based on a set of points.\n * @param {number} x - The value to interpolate.\n * @param {Array<{x: number, y: number}>} points - The sorted array of data points.\n * @returns {number} The interpolated y value.\n */const interpolate=(x,points)=>{if(points.length===0)return 0;if(points.length===1)return points[0].y;const sortedPoints=points.slice().sort((a,b)=>a.x-b.x);if(x<=sortedPoints[0].x)return sortedPoints[0].y;if(x>=sortedPoints[sortedPoints.length-1].x)return sortedPoints[sortedPoints.length-1].y;let i=0;while(i<sortedPoints.length&&sortedPoints[i].x<x){i++;}const p1=sortedPoints[i-1];const p2=sortedPoints[i];if(p1.x===p2.x)return p1.y;const slope=(p2.y-p1.y)/(p2.x-p1.x);return p1.y+slope*(x-p1.x);};// --- React Components ---\nconst Card=_ref=>{let{title,children}=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-md p-6 mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-4 border-b pb-2\",children:title}),children]});};const Step1=_ref2=>{let{objective,setObjective,criteria,setCriteria,options,setOptions}=_ref2;const[newCriterion,setNewCriterion]=useState('');const[newOption,setNewOption]=useState('');const garbageCanIcon=/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z\",clipRule:\"evenodd\"})});const plusIcon=/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-8 w-8\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 6v6m0 0v6m0-6h6m-6 0H6\"})});const addCriterion=()=>{if(newCriterion.trim()&&!criteria.find(c=>c.id===newCriterion.trim())){setCriteria([...criteria,{id:newCriterion.trim(),content:newCriterion.trim()}]);setNewCriterion('');}};const addOption=()=>{if(newOption.trim()&&!options.find(o=>o.id===newOption.trim())){setOptions([...options,{id:newOption.trim(),content:newOption.trim()}]);setNewOption('');}};const removeCriterion=index=>{const newCriteria=[...criteria];newCriteria.splice(index,1);setCriteria(newCriteria);};const removeOption=index=>{const newOptions=[...options];newOptions.splice(index,1);setOptions(newOptions);};const onDragEnd=result=>{const{source,destination,type}=result;if(!destination)return;const list=type==='CRITERIA'?criteria:options;const setList=type==='CRITERIA'?setCriteria:setOptions;const items=Array.from(list);const[reorderedItem]=items.splice(source.index,1);items.splice(destination.index,0,reorderedItem);setList(items);};const renderList=(items,type)=>/*#__PURE__*/_jsx(DragDropContext,{onDragEnd:onDragEnd,children:/*#__PURE__*/_jsx(Droppable,{droppableId:type,type:type,children:provided=>/*#__PURE__*/_jsxs(\"ul\",{...provided.droppableProps,ref:provided.innerRef,className:\"mt-2 space-y-2\",children:[items.map((item,index)=>/*#__PURE__*/_jsx(Draggable,{draggableId:item.id,index:index,children:(provided,snapshot)=>/*#__PURE__*/_jsxs(\"li\",{ref:provided.innerRef,...provided.draggableProps,...provided.dragHandleProps,className:`p-3 rounded-lg flex justify-between items-center transition-shadow ${snapshot.isDragging?'shadow-lg bg-blue-100':'bg-gray-100'}`,children:[/*#__PURE__*/_jsx(\"span\",{children:item.content}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>type==='CRITERIA'?removeCriterion(index):removeOption(index),className:\"text-gray-400 hover:text-red-600 transition-colors\",children:garbageCanIcon})]})},item.id)),provided.placeholder]})})});return/*#__PURE__*/_jsxs(Card,{title:\"Step 1: Define Goal, Criteria & Options\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"objective\",className:\"block text-xl font-semibold text-gray-700 mb-2\",children:\"Decision Objective\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"objective\",value:objective,onChange:e=>setObjective(e.target.value),placeholder:\"e.g., Select the best car for a family\",className:\"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none\",rows:\"2\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-2\",children:\"Criteria\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newCriterion,onChange:e=>setNewCriterion(e.target.value),onKeyPress:e=>e.key==='Enter'&&addCriterion(),placeholder:\"New criterion name\",className:\"flex-grow p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addCriterion,className:\"text-green-500 hover:text-green-600 transition-colors transform hover:scale-125\",children:plusIcon})]}),renderList(criteria,'CRITERIA')]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-2\",children:\"Options (Alternatives)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newOption,onChange:e=>setNewOption(e.target.value),onKeyPress:e=>e.key==='Enter'&&addOption(),placeholder:\"New option name\",className:\"flex-grow p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none\"}),/*#__PURE__*/_jsx(\"button\",{onClick:addOption,className:\"text-green-500 hover:text-green-600 transition-colors transform hover:scale-125\",children:plusIcon})]}),renderList(options,'OPTIONS')]})]})]});};const getIntensityDescription=value=>{const intValue=Math.round(value);switch(intValue){case 1:return\"Equal Importance: Two factors contribute equally to the objective.\";case 2:return\"Intermediate Importance between 1 and 3.\";case 3:return\"Somewhat More Important: Experience and judgment slightly favor one over the other.\";case 4:return\"Intermediate Importance between 3 and 5.\";case 5:return\"Much More Important: Experience and judgment strongly favor one over the other.\";case 6:return\"Intermediate Importance between 5 and 7.\";case 7:return\"Very Much More Important: A factor is favored very strongly over the other.\";case 8:return\"Intermediate Importance between 7 and 9.\";case 9:return\"Extremely More Important: The evidence favoring one factor over another is of the highest possible validity.\";default:return\"\";}};const ComparisonSlider=_ref3=>{let{crit1,crit2,value,onChange}=_ref3;// Convert matrix value to slider position (-8 to 8)\n// Negative slider value means crit1 is more important\n// Positive slider value means crit2 is more important\nconst sliderValue=value>=1?-(value-1):1/value-1;const handleSliderChange=e=>{const newSliderValue=parseFloat(e.target.value);let newMatrixValue;if(newSliderValue<=0){// Left side -> crit1 is more important\nnewMatrixValue=-newSliderValue+1;}else{// Right side -> crit2 is more important\nnewMatrixValue=1/(newSliderValue+1);}onChange(newMatrixValue);};let preferenceText;let intensityValue;if(value>1){preferenceText=`${crit1} is ${Math.round(value)}x more important than ${crit2}`;intensityValue=value;}else if(value<1){const inverseValue=1/value;preferenceText=`${crit2} is ${Math.round(inverseValue)}x more important than ${crit1}`;intensityValue=inverseValue;}else{preferenceText=\"Both criteria are equally important\";intensityValue=1;}return/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2 font-semibold text-gray-700\",children:[/*#__PURE__*/_jsx(\"span\",{children:crit1}),/*#__PURE__*/_jsx(\"span\",{children:crit2})]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"-8\",max:\"8\",step:\"1\",value:sliderValue,onChange:handleSliderChange,className:\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs text-gray-500 mt-1\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"More important\"}),/*#__PURE__*/_jsx(\"span\",{children:\"More important\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mt-3 p-2 bg-white rounded-md shadow-inner\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-blue-700\",children:preferenceText}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:getIntensityDescription(intensityValue)})]})]});};const Step2=_ref4=>{let{criteria,pairwiseMatrix,onMatrixChange,weights,consistency}=_ref4;const handleComparisonChange=(i,j,newValue)=>{const newMatrix=pairwiseMatrix.map(r=>r.slice());newMatrix[i][j]=newValue;newMatrix[j][i]=1/newValue;onMatrixChange(newMatrix);};return/*#__PURE__*/_jsxs(Card,{title:\"Step 2: Pairwise Comparison of Criteria\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 mb-6\",role:\"alert\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold\",children:\"How this works:\"}),/*#__PURE__*/_jsx(\"p\",{children:\"For each pair of criteria, move the slider to indicate which is more important and by how much. The scale ranges from 1 (equally important) to 9 (extremely more important). Your judgments will be used to calculate the weight, or overall importance, of each criterion.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:criteria.map((crit1,i)=>criteria.map((crit2,j)=>{if(i<j){var _pairwiseMatrix$i;return/*#__PURE__*/_jsx(ComparisonSlider,{crit1:crit1.content,crit2:crit2.content,value:((_pairwiseMatrix$i=pairwiseMatrix[i])===null||_pairwiseMatrix$i===void 0?void 0:_pairwiseMatrix$i[j])||1,onChange:newValue=>handleComparisonChange(i,j,newValue)},`${i}-${j}`);}return null;}))}),weights.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 p-4 bg-blue-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-2\",children:\"Results\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold\",children:\"Relative Importance (Weights)\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc list-inside\",children:criteria.map((criterion,index)=>/*#__PURE__*/_jsxs(\"li\",{children:[criterion.content,\": \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-mono\",children:[(weights[index]*100).toFixed(2),\"%\"]})]},criterion.id))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-bold\",children:\"Consistency Check\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Consistency Ratio (CR): \",/*#__PURE__*/_jsx(\"span\",{className:`font-mono font-bold ${consistency.isConsistent?'text-green-600':'text-red-600'}`,children:consistency.cr.toFixed(4)})]}),/*#__PURE__*/_jsx(\"p\",{className:`text-sm ${consistency.isConsistent?'text-green-700':'text-red-700'}`,children:consistency.isConsistent?'Judgments are consistent (CR < 0.1)':'Inconsistent judgments (CR >= 0.1). Please review your comparisons.'})]})]})]})]});};const UtilityChart=_ref5=>{let{utilityFunction}=_ref5;const chartData=useMemo(()=>{var _utilityFunction$poin;const points=((_utilityFunction$poin=utilityFunction.points)===null||_utilityFunction$poin===void 0?void 0:_utilityFunction$poin.slice().sort((a,b)=>a.x-b.x))||[];let labels,data;if(utilityFunction.criterionType==='quantitative'&&utilityFunction.mode==='formula'&&utilityFunction.formulaString){const minX=points.length>0?points[0].x:0;const maxX=points.length>0?points[points.length-1].x:100;const range=maxX-minX;labels=Array.from({length:11},(_,i)=>minX+i*(range/10));data=labels.map(x=>safeEval(utilityFunction.formulaString,x));}else if(utilityFunction.criterionType==='quantitative'){labels=points.map(p=>p.x);data=points.map(p=>p.y);}else{// Qualitative\nlabels=utilityFunction.qualitativeLevels.map(l=>l.label);data=utilityFunction.qualitativeLevels.map(l=>l.utility);}return{labels,datasets:[{label:'Utility',data,borderColor:'rgb(75, 192, 192)',backgroundColor:'rgba(75, 192, 192, 0.5)',tension:0.1}]};},[utilityFunction]);const chartOptions={responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{type:utilityFunction.criterionType==='quantitative'?'linear':'category',title:{display:true,text:'Criterion Value / Label'}},y:{title:{display:true,text:'Utility'},min:0,max:100}}};return/*#__PURE__*/_jsx(\"div\",{className:\"relative h-64 mt-4\",children:utilityFunction.criterionType==='quantitative'?/*#__PURE__*/_jsx(Line,{data:chartData,options:chartOptions}):/*#__PURE__*/_jsx(Bar,{data:chartData,options:chartOptions})});};const Step3=_ref6=>{let{criteria,utilityFunctions,setUtilityFunctions}=_ref6;const setFunctionData=(criterionId,data)=>{setUtilityFunctions(prev=>({...prev,[criterionId]:{...prev[criterionId],...data}}));};const addPoint=criterionId=>{const newPoints=[...utilityFunctions[criterionId].points,{x:0,y:0}];setFunctionData(criterionId,{points:newPoints});};const addQualitativeLevel=criterionId=>{const newLevels=[...utilityFunctions[criterionId].qualitativeLevels,{label:'New Level',utility:50}];setFunctionData(criterionId,{qualitativeLevels:newLevels});};const updatePoint=(criterionId,index,field,value)=>{const newPoints=[...utilityFunctions[criterionId].points];newPoints[index][field]=parseFloat(value)||0;setFunctionData(criterionId,{points:newPoints});};const updateQualitativeLevel=(criterionId,index,field,value)=>{const newLevels=[...utilityFunctions[criterionId].qualitativeLevels];newLevels[index][field]=field==='utility'?parseFloat(value)||0:value;setFunctionData(criterionId,{qualitativeLevels:newLevels});};const removePoint=(criterionId,index)=>{const newPoints=[...utilityFunctions[criterionId].points];newPoints.splice(index,1);setFunctionData(criterionId,{points:newPoints});};const removeQualitativeLevel=(criterionId,index)=>{const newLevels=[...utilityFunctions[criterionId].qualitativeLevels];newLevels.splice(index,1);setFunctionData(criterionId,{qualitativeLevels:newLevels});};const TabButton=_ref7=>{let{text,active,onClick}=_ref7;return/*#__PURE__*/_jsx(\"button\",{onClick:onClick,className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${active?'bg-blue-500 text-white':'bg-gray-200 text-gray-600 hover:bg-gray-300'}`,children:text});};return/*#__PURE__*/_jsx(Card,{title:\"Step 3: Define Utility Functions\",children:/*#__PURE__*/_jsx(\"div\",{className:\"space-y-8\",children:criteria.map(criterion=>{const funcData=utilityFunctions[criterion.id];if(!funcData)return null;// FIX: Prevent crash on new criterion\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-3\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-800\",children:criterion.content}),/*#__PURE__*/_jsxs(\"select\",{value:funcData.criterionType,onChange:e=>setFunctionData(criterion.id,{criterionType:e.target.value}),className:\"p-2 border rounded-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"quantitative\",children:\"Quantitative\"}),/*#__PURE__*/_jsx(\"option\",{value:\"qualitative\",children:\"Qualitative\"})]})]}),funcData.criterionType==='quantitative'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-b border-gray-300\",children:[/*#__PURE__*/_jsx(TabButton,{text:\"Formula\",active:funcData.mode==='formula',onClick:()=>setFunctionData(criterion.id,{mode:'formula'})}),/*#__PURE__*/_jsx(TabButton,{text:\"Table\",active:funcData.mode==='table',onClick:()=>setFunctionData(criterion.id,{mode:'table'})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[funcData.mode==='formula'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Formula (e.g., 100 - x/1000)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter formula with 'x'\",value:funcData.formulaString,onChange:e=>setFunctionData(criterion.id,{formulaString:e.target.value}),className:\"w-full p-2 border rounded-lg mt-1\"})]}),funcData.mode==='table'&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Define with Points\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 mt-1 max-h-48 overflow-y-auto pr-2\",children:funcData.points.map((point,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:point.x,onChange:e=>updatePoint(criterion.id,index,'x',e.target.value),className:\"w-full p-1 border rounded-md\",placeholder:\"Value\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2192\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:point.y,onChange:e=>updatePoint(criterion.id,index,'y',e.target.value),className:\"w-full p-1 border rounded-md\",placeholder:\"Utility\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removePoint(criterion.id,index),className:\"text-red-500 hover:text-red-700\",children:\"X\"})]},index))}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addPoint(criterion.id),className:\"mt-2 text-sm bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600\",children:\"Add Point\"})]})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(UtilityChart,{utilityFunction:funcData})})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700\",children:\"Define Qualitative Levels\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 mt-1 max-h-48 overflow-y-auto pr-2\",children:funcData.qualitativeLevels.map((level,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:level.label,onChange:e=>updateQualitativeLevel(criterion.id,index,'label',e.target.value),className:\"w-full p-1 border rounded-md\",placeholder:\"Label (e.g., High)\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u2192\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:level.utility,onChange:e=>updateQualitativeLevel(criterion.id,index,'utility',e.target.value),className:\"w-full p-1 border rounded-md\",placeholder:\"Utility\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeQualitativeLevel(criterion.id,index),className:\"text-red-500 hover:text-red-700\",children:\"X\"})]},index))}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addQualitativeLevel(criterion.id),className:\"mt-2 text-sm bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600\",children:\"Add Level\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(UtilityChart,{utilityFunction:funcData})})]})]},criterion.id);})})});};const Step4=_ref8=>{let{options,criteria,optionValues,setOptionValues,utilityFunctions,utilityScores,setUtilityScores}=_ref8;const handleValueChange=(optionId,criterionId,value)=>{setOptionValues(prev=>({...prev,[optionId]:{...prev[optionId],[criterionId]:value}}));};const calculateScores=useCallback(()=>{const newUtilityScores={};options.forEach(option=>{newUtilityScores[option.id]={};criteria.forEach(criterion=>{const func=utilityFunctions[criterion.id];let utility=0;if(func){if(func.criterionType==='qualitative'){var _optionValues$option$;const selectedLabel=(_optionValues$option$=optionValues[option.id])===null||_optionValues$option$===void 0?void 0:_optionValues$option$[criterion.id];const level=func.qualitativeLevels.find(l=>l.label===selectedLabel);if(level){utility=level.utility;}}else{var _optionValues$option$2;const value=parseFloat((_optionValues$option$2=optionValues[option.id])===null||_optionValues$option$2===void 0?void 0:_optionValues$option$2[criterion.id]);if(!isNaN(value)){if(func.mode==='formula'&&func.formulaString){const result=safeEval(func.formulaString,value);if(result!==null)utility=result;}else if(func.mode==='table'&&func.points&&func.points.length>0){utility=interpolate(value,func.points);}}}}newUtilityScores[option.id][criterion.id]=Math.max(0,Math.min(100,utility));});});setUtilityScores(newUtilityScores);},[options,criteria,optionValues,utilityFunctions,setUtilityScores]);useEffect(()=>{calculateScores();},[calculateScores]);return/*#__PURE__*/_jsxs(Card,{title:\"Step 4: Evaluate Alternatives & Calculate Utility\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-4\",children:\"Enter the value for each option against each criterion. For qualitative criteria, select the appropriate level from the dropdown.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full text-left border-collapse\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"p-3 bg-gray-100 font-semibold text-gray-700 border-b-2 border-gray-200\",children:\"Option\"}),criteria.map(c=>/*#__PURE__*/_jsx(\"th\",{className:\"p-3 bg-gray-100 font-semibold text-gray-700 border-b-2 border-gray-200\",children:c.content},c.id))]})}),/*#__PURE__*/_jsx(\"tbody\",{children:options.map(option=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"p-3 border-b border-gray-200 font-semibold\",children:option.content}),criteria.map(criterion=>{var _utilityFunctions$cri,_optionValues$option$3,_optionValues$option$4,_utilityScores$option;return/*#__PURE__*/_jsxs(\"td\",{className:\"p-2 border-b border-gray-200\",children:[((_utilityFunctions$cri=utilityFunctions[criterion.id])===null||_utilityFunctions$cri===void 0?void 0:_utilityFunctions$cri.criterionType)==='qualitative'?/*#__PURE__*/_jsxs(\"select\",{value:((_optionValues$option$3=optionValues[option.id])===null||_optionValues$option$3===void 0?void 0:_optionValues$option$3[criterion.id])||'',onChange:e=>handleValueChange(option.id,criterion.id,e.target.value),className:\"w-full p-1 border rounded-md mb-1\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Level\"}),utilityFunctions[criterion.id].qualitativeLevels.map(level=>/*#__PURE__*/_jsx(\"option\",{value:level.label,children:level.label},level.label))]}):/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:((_optionValues$option$4=optionValues[option.id])===null||_optionValues$option$4===void 0?void 0:_optionValues$option$4[criterion.id])||'',onChange:e=>handleValueChange(option.id,criterion.id,e.target.value),className:\"w-full p-1 border rounded-md mb-1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right text-xs text-gray-400\",children:[\"Utility: \",(((_utilityScores$option=utilityScores[option.id])===null||_utilityScores$option===void 0?void 0:_utilityScores$option[criterion.id])||0).toFixed(0)]})]},criterion.id);})]},option.id))})]})})]});};const Step5=_ref9=>{let{onGenerateReport,...props}=_ref9;const{objective,options,criteria,weights,utilityScores}=props;const finalScores=useMemo(()=>{const scores={};options.forEach(option=>{let totalScore=0;criteria.forEach((criterion,index)=>{var _utilityScores$option2;const utility=((_utilityScores$option2=utilityScores[option.id])===null||_utilityScores$option2===void 0?void 0:_utilityScores$option2[criterion.id])||0;const weight=weights[index]||0;totalScore+=utility*weight;});scores[option.id]=totalScore;});return scores;},[options,criteria,weights,utilityScores]);const sortedOptions=useMemo(()=>options.map(o=>({...o,score:finalScores[o.id]||0})).sort((a,b)=>b.score-a.score),[options,finalScores]);const chartData={labels:sortedOptions.map(o=>o.content),datasets:[{label:'Final Scores',data:sortedOptions.map(o=>o.score),backgroundColor:'rgba(54, 162, 235, 0.6)',borderColor:'rgba(54, 162, 235, 1)',borderWidth:1}]};const chartOptions={indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},title:{display:true,text:'Final Decision Ranking',font:{size:18}}},scales:{x:{beginAtZero:true,title:{display:true,text:'Total Weighted Score'}}}};return/*#__PURE__*/_jsxs(Card,{title:\"Step 5: View Results & Export Report\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700\",children:\"Decision Objective\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-1\",children:objective})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-8 items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-700 mb-2\",children:\"Final Ranking\"}),/*#__PURE__*/_jsx(\"ol\",{className:\"list-decimal list-inside space-y-2\",children:sortedOptions.map((option,index)=>/*#__PURE__*/_jsxs(\"li\",{className:`p-3 rounded-lg ${index===0?'bg-green-100 text-green-800 font-bold':'bg-gray-100'}`,children:[/*#__PURE__*/_jsxs(\"span\",{className:\"mr-2\",children:[option.content,\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"font-mono\",children:option.score.toFixed(2)})]},option.id))}),/*#__PURE__*/_jsxs(\"button\",{onClick:onGenerateReport,className:\"mt-6 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors w-full flex items-center justify-center gap-2 text-lg\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-6 w-6\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z\"})}),\"Generate Report\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"relative h-96\",children:/*#__PURE__*/_jsx(Bar,{data:chartData,options:chartOptions})})]})]});};const ReportPage=_ref0=>{let{data,onBack}=_ref0;useEffect(()=>{if(!data){onBack();return;}const{objective,sortedOptions,criteria,weights,consistency,pairwiseMatrix,utilityFunctions,optionValues}=data;const reportWindow=window.open('','_blank');if(reportWindow){var _sortedOptions$,_sortedOptions$2,_sortedOptions$3;const resultsTable=sortedOptions.map((opt,index)=>`\n                <tr class=\"hover:bg-gray-50\">\n                    <td class=\"p-3 border\">${index+1}</td>\n                    <td class=\"p-3 border font-semibold\">${opt.content}</td>\n                    <td class=\"p-3 border font-mono\">${opt.score.toFixed(2)}</td>\n                </tr>\n            `).join('');const weightsTable=criteria.map((crit,index)=>`\n                <tr class=\"hover:bg-gray-50\">\n                    <td class=\"p-3 border\">${crit.content}</td>\n                    <td class=\"p-3 border font-mono\">${(weights[index]*100).toFixed(2)}%</td>\n                </tr>\n            `).join('');const simplifiedPairwise=criteria.map((crit1,i)=>{return criteria.map((crit2,j)=>{if(i>=j)return null;const value=pairwiseMatrix[i][j];let intensity;if(value>=1){intensity=(value-1)/8*50;return`<div class=\"flex items-center justify-between p-2\"><span class=\"w-1/3 text-right\">${crit1.content}</span><div class=\"w-1/3 mx-2 h-2 bg-gray-200 rounded-full\"><div class=\"h-2 bg-blue-500 rounded-l-full\" style=\"width:${intensity}%; margin-left:${50-intensity}%\"></div></div><span class=\"w-1/3 text-left\">${crit2.content}</span></div>`;}else{const inv=1/value;intensity=(inv-1)/8*50;return`<div class=\"flex items-center justify-between p-2\"><span class=\"w-1/3 text-right\">${crit1.content}</span><div class=\"w-1/3 mx-2 h-2 bg-gray-200 rounded-full\"><div class=\"h-2 bg-blue-500 rounded-r-full\" style=\"width:${intensity}%; margin-left:50%\"></div></div><span class=\"w-1/3 text-left\">${crit2.content}</span></div>`;}}).filter(Boolean).join('');}).join('');const utilityAppendix=criteria.map(crit=>{const func=utilityFunctions[crit.id];let content;if(func.criterionType==='qualitative'){const levels=func.qualitativeLevels.map(l=>`<li>${l.label}: ${l.utility}</li>`).join('');content=`<ul>${levels}</ul>`;}else if(func.mode==='formula'){content=`<p class=\"font-mono bg-gray-100 p-2 rounded\">f(x) = ${func.formulaString}</p>`;}else{const points=func.points.map(p=>`<li>Value ${p.x} → Utility ${p.y}</li>`).join('');content=`<ul>${points}</ul>`;}return`<div class=\"mb-4\"><h4 class=\"font-semibold\">${crit.content} (${func.criterionType})</h4>${content}</div>`;}).join('');const evaluationsHeader=criteria.map(c=>`<th class=\"p-2 border\">${c.content}</th>`).join('');const evaluationsBody=data.options.map(option=>`\n                <tr>\n                    <th class=\"p-2 border bg-gray-100\">${option.content}</th>\n                    ${criteria.map(criterion=>{var _optionValues$option$5;return`<td class=\"p-2 border text-center font-mono\">${((_optionValues$option$5=optionValues[option.id])===null||_optionValues$option$5===void 0?void 0:_optionValues$option$5[criterion.id])||'N/A'}</td>`;}).join('')}\n                </tr>\n            `).join('');reportWindow.document.write(`\n                <!DOCTYPE html>\n                <html lang=\"en\">\n                <head>\n                    <meta charset=\"UTF-8\">\n                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                    <title>AHP Analysis Report</title>\n                    <script src=\"https://cdn.tailwindcss.com\"></script>\n                    <style>\n                        @media print { .no-print { display: none; } body { -webkit-print-color-adjust: exact; } }\n                        section { page-break-inside: avoid; }\n                    </style>\n                </head>\n                <body class=\"bg-white p-8 md:p-12 font-sans\">\n                    <div class=\"no-print mb-8 text-center flex justify-center gap-4\">\n                        <button onclick=\"window.close()\" class=\"bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors\">\n                            ← Close Report\n                        </button>\n                        <button onclick=\"window.print()\" class=\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors\">\n                            Print or Save as PDF\n                        </button>\n                    </div>\n                    <div class=\"max-w-4xl mx-auto\">\n                        <header class=\"text-center border-b-2 pb-4 mb-8\">\n                            <h1 class=\"text-4xl font-bold text-gray-800\">Decision Analysis Report</h1>\n                            <p class=\"text-lg text-gray-600 mt-2\">Analytic Hierarchy Process (AHP)</p>\n                        </header>\n                        <section class=\"mb-10\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">1. About This Report</h2>\n                            <p class=\"text-gray-700 mb-2\">This report uses the Analytic Hierarchy Process (AHP) to break down a complex decision into a structured system of goals, criteria, and alternatives. This allows for a systematic and rational evaluation. For more details on the methodology, see the <a href=\"https://www.burgehugheswalsh.co.uk/Uploaded/1/Documents/Analytic-Hierarchy-Process-Tool-v2.pdf\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"text-blue-600 hover:underline\">AHP explanation document</a>.</p>\n                        </section>\n                        <section class=\"mb-10\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">2. Executive Summary</h2>\n                            <p class=\"text-lg text-gray-700 mb-2\"><strong>Decision Goal:</strong> ${objective}</p>\n                            <div class=\"bg-green-100 border-l-4 border-green-500 text-green-800 p-4 rounded-r-lg\">\n                                <p class=\"font-bold text-xl\">Recommendation: ${((_sortedOptions$=sortedOptions[0])===null||_sortedOptions$===void 0?void 0:_sortedOptions$.content)||'N/A'}</p>\n                                <p>Based on the criteria and weightings provided, the recommended option is <strong>${((_sortedOptions$2=sortedOptions[0])===null||_sortedOptions$2===void 0?void 0:_sortedOptions$2.content)||'N/A'}</strong> with a final score of <strong>${((_sortedOptions$3=sortedOptions[0])===null||_sortedOptions$3===void 0?void 0:_sortedOptions$3.score.toFixed(2))||'0.00'}</strong>.</p>\n                            </div>\n                        </section>\n                        <section class=\"mb-10\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">3. Final Results</h2>\n                            <table class=\"w-full text-left border-collapse\">\n                                <thead class=\"bg-gray-100\"><tr><th class=\"p-3 border\">Rank</th><th class=\"p-3 border\">Option</th><th class=\"p-3 border\">Final Score</th></tr></thead>\n                                <tbody>${resultsTable}</tbody>\n                            </table>\n                        </section>\n                        <section class=\"mb-10\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">4. Criteria Weights & Consistency</h2>\n                            <p class=\"text-gray-600 mb-4\">The following weights were determined by comparing the relative importance of each criterion. The Consistency Ratio (CR) checks for contradictions in the judgments; a value below 0.10 is considered acceptable.</p>\n                            <div class=\"grid md:grid-cols-2 gap-8\">\n                                <table class=\"w-full text-left border-collapse\">\n                                    <thead class=\"bg-gray-100\"><tr><th class=\"p-3 border\">Criterion</th><th class=\"p-3 border\">Weight</th></tr></thead>\n                                    <tbody>${weightsTable}</tbody>\n                                </table>\n                                <div class=\"p-4 bg-gray-100 rounded-lg\">\n                                    <h4 class=\"font-bold text-lg\">Consistency Check</h4>\n                                    <p class=\"text-2xl font-mono ${consistency.isConsistent?'text-green-600':'text-red-600'}\">${consistency.cr.toFixed(4)}</p>\n                                    <p>${consistency.isConsistent?'Judgments are consistent.':'Judgments are inconsistent.'}</p>\n                                </div>\n                            </div>\n                        </section>\n                        <section class=\"mb-10\" style=\"page-break-before: always;\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">5. Appendix</h2>\n                            <h3 class=\"text-xl font-semibold text-gray-700 mt-6 mb-2\">A. Simplified Pairwise Comparisons</h3>\n                            <div class=\"space-y-2\">${simplifiedPairwise}</div>\n                            <h3 class=\"text-xl font-semibold text-gray-700 mt-8 mb-2\">B. Utility Functions</h3>\n                            <div class=\"p-4 border rounded-lg\">${utilityAppendix}</div>\n                            <h3 class=\"text-xl font-semibold text-gray-700 mt-8 mb-2\">C. Option Evaluations</h3>\n                            <table class=\"w-full text-left border-collapse text-sm\">\n                                <thead class=\"bg-gray-100\"><tr><th class=\"p-2 border\">Option</th>${evaluationsHeader}</tr></thead>\n                                <tbody>${evaluationsBody}</tbody>\n                            </table>\n                        </section>\n                    </div>\n                </body>\n                </html>\n            `);reportWindow.document.close();}},[data,onBack]);if(!data){return/*#__PURE__*/_jsx(\"div\",{className:\"p-8\",children:\"Loading report data...\"});}return null;// This component now only handles opening the report\n};function App(){const[objective,setObjective]=useState(\"Choose the best car for a family\");const[criteria,setCriteria]=useState([{id:'Risk',content:'Risk'},{id:'SW Effort/Schedule',content:'SW Effort/Schedule'},{id:'HW Costs',content:'HW Costs'},{id:'Future Adaptability',content:'Future Adaptability'}]);const[options,setOptions]=useState([{id:'Dual Primary',content:'Dual Primary'},{id:'Compressed Dual Primary',content:'Compressed Dual Primary'},{id:'Compressed Asymmetric Primary',content:'Compressed Asymmetric Primary'},{id:'Tele-assisted Secondary',content:'Tele-assisted Secondary'}]);const[pairwiseMatrix,setPairwiseMatrix]=useState([[1,9,7,7],[1/9,1,3,1/3],[1/7,1/3,1,5],[1/7,3,1/5,1]]);const[weights,setWeights]=useState([]);const[consistency,setConsistency]=useState({cr:0,isConsistent:true});const[utilityFunctions,setUtilityFunctions]=useState({'Risk':{criterionType:'qualitative',mode:'table',formulaString:'',points:[],qualitativeLevels:[{label:'Low',utility:100},{label:'Medium',utility:50},{label:'High',utility:0}]},'SW Effort/Schedule':{criterionType:'quantitative',mode:'table',formulaString:'',points:[{x:0,y:0},{x:100,y:100}],qualitativeLevels:[]},'HW Costs':{criterionType:'quantitative',mode:'formula',formulaString:'100 * (400000 - x) / (400000 - 300000)',points:[{x:300000,y:100},{x:400000,y:0}],qualitativeLevels:[]},'Future Adaptability':{criterionType:'quantitative',mode:'table',formulaString:'',points:[{x:0,y:0},{x:100,y:100}],qualitativeLevels:[]}});const[optionValues,setOptionValues]=useState({});const[view,setView]=useState('main');// 'main' or 'report'\nconst finalScores=useMemo(()=>{if(criteria.length===0||options.length===0)return[];try{const normalizedMatrix=normalizeMatrix(pairwiseMatrix);const weights=calculateWeights(normalizedMatrix);const calculatedOptionValues=calculateOptionValues(options,criteria,utilityFunctions);const scores=calculateFinalScores(options,criteria,weights,calculatedOptionValues);return scores;}catch(error){console.error(\"Error calculating final scores:\",error);return[];}},[criteria,options,pairwiseMatrix,utilityFunctions]);const sortedOptions=useMemo(()=>{if(finalScores.length===0)return[];const enrichedOptions=options.map(opt=>{var _finalScores$find;return{...opt,score:((_finalScores$find=finalScores.find(s=>s.optionId===opt.id))===null||_finalScores$find===void 0?void 0:_finalScores$find.score)||0};});return enrichedOptions.sort((a,b)=>b.score-a.score);},[options,finalScores]);const handleSave=()=>{const dataStr=JSON.stringify({objective,criteria,options,pairwiseMatrix,utilityFunctions,optionValues});const blob=new Blob([dataStr],{type:\"application/json\"});const url=URL.createObjectURL(blob);const a=document.createElement(\"a\");a.href=url;a.download=\"ahp_data.json\";a.click();URL.revokeObjectURL(url);};const handleLoad=event=>{const file=event.target.files[0];if(!file)return;const reader=new FileReader();reader.onload=e=>{try{const data=JSON.parse(e.target.result);setObjective(data.objective);setCriteria(data.criteria);setOptions(data.options);setPairwiseMatrix(data.pairwiseMatrix);setUtilityFunctions(data.utilityFunctions);setOptionValues(data.optionValues);}catch(error){console.error(\"Error loading file:\",error);}};reader.readAsText(file);};if(view==='report'){const reportData={objective,sortedOptions,criteria,weights:calculateWeights(normalizeMatrix(pairwiseMatrix)),consistency:checkConsistency(pairwiseMatrix),pairwiseMatrix,utilityFunctions,optionValues:calculateOptionValues(options,criteria,utilityFunctions),options};return/*#__PURE__*/_jsx(ReportPage,{data:reportData,onBack:()=>setView('main')});}return/*#__PURE__*/_jsx(DndProvider,{backend:HTML5Backend,children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 min-h-screen font-sans\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-50 border-b-2 border-green-200 p-4\",children:/*#__PURE__*/_jsxs(\"header\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl md:text-5xl font-extrabold text-green-800\",children:\"AHP Decision-Making Tool\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-green-700 mt-2\",children:\"A structured approach to complex decision-making.\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto p-4 md:p-8\",children:/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(Step1,{objective:objective,setObjective:setObjective,criteria:criteria,setCriteria:setCriteria,options:options,setOptions:setOptions}),/*#__PURE__*/_jsx(Step2,{criteria:criteria,pairwiseMatrix:pairwiseMatrix,onMatrixChange:handleMatrixChange,weights:weights,consistency:consistency}),/*#__PURE__*/_jsx(Step3,{criteria:criteria,utilityFunctions:utilityFunctions,setUtilityFunctions:setUtilityFunctions}),/*#__PURE__*/_jsx(Step4,{options:options,criteria:criteria,optionValues:optionValues,setOptionValues:setOptionValues,utilityFunctions:utilityFunctions,utilityScores:utilityScores,setUtilityScores:setUtilityScores}),weights.length>0&&Object.keys(utilityScores).length>0&&/*#__PURE__*/_jsx(Step5,{objective:objective,options:options,criteria:criteria,weights:weights,consistency:consistency,utilityScores:utilityScores,pairwiseMatrix:pairwiseMatrix,utilityFunctions:utilityFunctions,optionValues:optionValues,onGenerateReport:handleGenerateReport})]})})]})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useMemo","DragDropContext","Droppable","Draggable","Bar","Line","Chart","ChartJS","CategoryScale","LinearScale","BarElement","LineElement","PointElement","Title","Tooltip","Legend","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","register","calculateWeights","pairwiseMatrix","length","numCriteria","columnSums","Array","fill","j","i","normalizedMatrix","map","row","slice","weights","reduce","sum","val","calculateConsistency","cr","isConsistent","weightedSumVector","consistencyVector","lambdaMax","ci","riMap","ri","safeEval","expr","x","test","func","Function","result","isNaN","error","interpolate","points","y","sortedPoints","sort","a","b","p1","p2","slope","Card","_ref","title","children","className","Step1","_ref2","objective","setObjective","criteria","setCriteria","options","setOptions","newCriterion","setNewCriterion","newOption","setNewOption","garbageCanIcon","xmlns","viewBox","fillRule","d","clipRule","plusIcon","stroke","strokeLinecap","strokeLinejoin","strokeWidth","addCriterion","trim","find","c","id","content","addOption","o","removeCriterion","index","newCriteria","splice","removeOption","newOptions","onDragEnd","source","destination","type","list","setList","items","from","reorderedItem","renderList","droppableId","provided","droppableProps","ref","innerRef","item","draggableId","snapshot","draggableProps","dragHandleProps","isDragging","onClick","placeholder","htmlFor","value","onChange","e","target","rows","onKeyPress","key","getIntensityDescription","intValue","Math","round","ComparisonSlider","_ref3","crit1","crit2","sliderValue","handleSliderChange","newSliderValue","parseFloat","newMatrixValue","preferenceText","intensityValue","inverseValue","min","max","step","Step2","_ref4","onMatrixChange","consistency","handleComparisonChange","newValue","newMatrix","r","role","_pairwiseMatrix$i","criterion","toFixed","UtilityChart","_ref5","utilityFunction","chartData","_utilityFunction$poin","labels","data","criterionType","mode","formulaString","minX","maxX","range","_","p","qualitativeLevels","l","label","utility","datasets","borderColor","backgroundColor","tension","chartOptions","responsive","maintainAspectRatio","plugins","legend","display","scales","text","Step3","_ref6","utilityFunctions","setUtilityFunctions","setFunctionData","criterionId","prev","addPoint","newPoints","addQualitativeLevel","newLevels","updatePoint","field","updateQualitativeLevel","removePoint","removeQualitativeLevel","TabButton","_ref7","active","funcData","point","level","Step4","_ref8","optionValues","setOptionValues","utilityScores","setUtilityScores","handleValueChange","optionId","calculateScores","newUtilityScores","forEach","option","_optionValues$option$","selectedLabel","_optionValues$option$2","_utilityFunctions$cri","_optionValues$option$3","_optionValues$option$4","_utilityScores$option","Step5","_ref9","onGenerateReport","props","finalScores","scores","totalScore","_utilityScores$option2","weight","sortedOptions","score","borderWidth","indexAxis","font","size","beginAtZero","ReportPage","_ref0","onBack","reportWindow","window","open","_sortedOptions$","_sortedOptions$2","_sortedOptions$3","resultsTable","opt","join","weightsTable","crit","simplifiedPairwise","intensity","inv","filter","Boolean","utilityAppendix","levels","evaluationsHeader","evaluationsBody","_optionValues$option$5","document","write","close","App","setPairwiseMatrix","setWeights","setConsistency","view","setView","normalizeMatrix","calculatedOptionValues","calculateOptionValues","calculateFinalScores","console","enrichedOptions","_finalScores$find","s","handleSave","dataStr","JSON","stringify","blob","Blob","url","URL","createObjectURL","createElement","href","download","click","revokeObjectURL","handleLoad","event","file","files","reader","FileReader","onload","parse","readAsText","reportData","checkConsistency","DndProvider","backend","HTML5Backend","handleMatrixChange","Object","keys","handleGenerateReport"],"sources":["/Users/amarchuk/Documents/ahp-decision-tool/ahp-decision-tool/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\nimport { Bar, Line } from 'react-chartjs-2';\nimport {\n  Chart as ChartJS,\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  LineElement,\n  PointElement,\n  Title,\n  Tooltip,\n  Legend,\n} from 'chart.js';\n\n// Register Chart.js components\nChartJS.register(\n  CategoryScale,\n  LinearScale,\n  BarElement,\n  LineElement,\n  PointElement,\n  Title,\n  Tooltip,\n  Legend\n);\n\n// --- AHP Calculation Helper Functions ---\n\n/**\n * Calculates the priority vector (weights) from a pairwise comparison matrix.\n * @param {number[][]} pairwiseMatrix - The n x n matrix of pairwise comparisons.\n * @returns {number[]} An array of weights for each criterion.\n */\nconst calculateWeights = (pairwiseMatrix) => {\n  if (!pairwiseMatrix || pairwiseMatrix.length === 0) {\n    return [];\n  }\n  const numCriteria = pairwiseMatrix.length;\n  const columnSums = Array(numCriteria).fill(0);\n\n  // Sum each column\n  for (let j = 0; j < numCriteria; j++) {\n    for (let i = 0; i < numCriteria; i++) {\n      columnSums[j] += pairwiseMatrix[i][j];\n    }\n  }\n\n  // Normalize the matrix by dividing each element by its column sum\n  const normalizedMatrix = pairwiseMatrix.map(row => row.slice());\n  for (let j = 0; j < numCriteria; j++) {\n    if (columnSums[j] === 0) continue;\n    for (let i = 0; i < numCriteria; i++) {\n      normalizedMatrix[i][j] /= columnSums[j];\n    }\n  }\n\n  // Calculate the average of each row to get the weights\n  const weights = Array(numCriteria).fill(0);\n  for (let i = 0; i < numCriteria; i++) {\n    weights[i] = normalizedMatrix[i].reduce((sum, val) => sum + val, 0) / numCriteria;\n  }\n\n  return weights;\n};\n\n/**\n * Calculates the consistency ratio (CR) to check for inconsistencies in judgments.\n * @param {number[][]} pairwiseMatrix - The n x n matrix of pairwise comparisons.\n * @param {number[]} weights - The calculated weights for each criterion.\n * @returns {{cr: number, isConsistent: boolean}} An object containing the consistency ratio and a boolean indicating if judgments are consistent.\n */\nconst calculateConsistency = (pairwiseMatrix, weights) => {\n  const numCriteria = pairwiseMatrix.length;\n  if (numCriteria <= 2) {\n    return { cr: 0, isConsistent: true };\n  }\n\n  const weightedSumVector = Array(numCriteria).fill(0);\n  for (let i = 0; i < numCriteria; i++) {\n    for (let j = 0; j < numCriteria; j++) {\n      weightedSumVector[i] += pairwiseMatrix[i][j] * weights[j];\n    }\n  }\n\n  const consistencyVector = Array(numCriteria).fill(0);\n  for (let i = 0; i < numCriteria; i++) {\n    if (weights[i] !== 0) {\n      consistencyVector[i] = weightedSumVector[i] / weights[i];\n    }\n  }\n\n  const lambdaMax = consistencyVector.reduce((sum, val) => sum + val, 0) / numCriteria;\n  const ci = (lambdaMax - numCriteria) / (numCriteria - 1);\n  \n  // Random Index (RI) from Saaty's scale for n=1 to 10\n  const riMap = [0, 0, 0.58, 0.9, 1.12, 1.24, 1.32, 1.41, 1.45, 1.49];\n  const ri = riMap[numCriteria-1] || 1.49; // Default to last value if > 10\n\n  const cr = ri === 0 ? 0 : ci / ri;\n\n  return { cr, isConsistent: cr < 0.1 };\n};\n\n/**\n * Safely evaluates a mathematical expression with a variable 'x'.\n * @param {string} expr - The mathematical expression string.\n * @param {number} x - The value to substitute for 'x'.\n * @returns {number | null} The result of the expression or null if invalid.\n */\nconst safeEval = (expr, x) => {\n    try {\n        if (/[^x\\d\\s()+\\-*/.]/.test(expr)) {\n            return null;\n        }\n        const func = new Function('x', `return ${expr}`);\n        const result = func(x);\n        return isNaN(result) ? null : result;\n    } catch (error) {\n        return null;\n    }\n};\n\n/**\n * Performs linear interpolation for a value x based on a set of points.\n * @param {number} x - The value to interpolate.\n * @param {Array<{x: number, y: number}>} points - The sorted array of data points.\n * @returns {number} The interpolated y value.\n */\nconst interpolate = (x, points) => {\n    if (points.length === 0) return 0;\n    if (points.length === 1) return points[0].y;\n    \n    const sortedPoints = points.slice().sort((a,b) => a.x - b.x);\n\n    if (x <= sortedPoints[0].x) return sortedPoints[0].y;\n    if (x >= sortedPoints[sortedPoints.length - 1].x) return sortedPoints[sortedPoints.length - 1].y;\n\n    let i = 0;\n    while (i < sortedPoints.length && sortedPoints[i].x < x) {\n        i++;\n    }\n\n    const p1 = sortedPoints[i - 1];\n    const p2 = sortedPoints[i];\n    \n    if (p1.x === p2.x) return p1.y;\n\n    const slope = (p2.y - p1.y) / (p2.x - p1.x);\n    return p1.y + slope * (x - p1.x);\n};\n\n\n// --- React Components ---\n\nconst Card = ({ title, children }) => (\n    <div className=\"bg-white rounded-xl shadow-md p-6 mb-8\">\n        <h2 className=\"text-2xl font-bold text-gray-800 mb-4 border-b pb-2\">{title}</h2>\n        {children}\n    </div>\n);\n\nconst Step1 = ({ objective, setObjective, criteria, setCriteria, options, setOptions }) => {\n  const [newCriterion, setNewCriterion] = useState('');\n  const [newOption, setNewOption] = useState('');\n  \n  const garbageCanIcon = (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n        <path fillRule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z\" clipRule=\"evenodd\" />\n    </svg>\n  );\n  \n  const plusIcon = (\n    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-8 w-8\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\n    </svg>\n  );\n\n  const addCriterion = () => {\n    if (newCriterion.trim() && !criteria.find(c => c.id === newCriterion.trim())) {\n      setCriteria([...criteria, {id: newCriterion.trim(), content: newCriterion.trim()}]);\n      setNewCriterion('');\n    }\n  };\n\n  const addOption = () => {\n    if (newOption.trim() && !options.find(o => o.id === newOption.trim())) {\n      setOptions([...options, {id: newOption.trim(), content: newOption.trim()}]);\n      setNewOption('');\n    }\n  };\n  \n  const removeCriterion = (index) => {\n      const newCriteria = [...criteria];\n      newCriteria.splice(index, 1);\n      setCriteria(newCriteria);\n  }\n  \n  const removeOption = (index) => {\n      const newOptions = [...options];\n      newOptions.splice(index, 1);\n      setOptions(newOptions);\n  }\n\n  const onDragEnd = (result) => {\n    const { source, destination, type } = result;\n    if (!destination) return;\n    \n    const list = type === 'CRITERIA' ? criteria : options;\n    const setList = type === 'CRITERIA' ? setCriteria : setOptions;\n\n    const items = Array.from(list);\n    const [reorderedItem] = items.splice(source.index, 1);\n    items.splice(destination.index, 0, reorderedItem);\n    setList(items);\n  };\n\n  const renderList = (items, type) => (\n    <DragDropContext onDragEnd={onDragEnd}>\n        <Droppable droppableId={type} type={type}>\n            {(provided) => (\n                <ul {...provided.droppableProps} ref={provided.innerRef} className=\"mt-2 space-y-2\">\n                    {items.map((item, index) => (\n                        <Draggable key={item.id} draggableId={item.id} index={index}>\n                            {(provided, snapshot) => (\n                                <li\n                                    ref={provided.innerRef}\n                                    {...provided.draggableProps}\n                                    {...provided.dragHandleProps}\n                                    className={`p-3 rounded-lg flex justify-between items-center transition-shadow ${snapshot.isDragging ? 'shadow-lg bg-blue-100' : 'bg-gray-100'}`}\n                                >\n                                    <span>{item.content}</span>\n                                    <button onClick={() => type === 'CRITERIA' ? removeCriterion(index) : removeOption(index)} className=\"text-gray-400 hover:text-red-600 transition-colors\">\n                                        {garbageCanIcon}\n                                    </button>\n                                </li>\n                            )}\n                        </Draggable>\n                    ))}\n                    {provided.placeholder}\n                </ul>\n            )}\n        </Droppable>\n    </DragDropContext>\n  );\n\n  return (\n    <Card title=\"Step 1: Define Goal, Criteria & Options\">\n        <div className=\"mb-6\">\n            <label htmlFor=\"objective\" className=\"block text-xl font-semibold text-gray-700 mb-2\">Decision Objective</label>\n            <textarea\n                id=\"objective\"\n                value={objective}\n                onChange={(e) => setObjective(e.target.value)}\n                placeholder=\"e.g., Select the best car for a family\"\n                className=\"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none\"\n                rows=\"2\"\n            />\n        </div>\n        <div className=\"grid md:grid-cols-2 gap-8\">\n            <div>\n                <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">Criteria</h3>\n                <div className=\"flex gap-2\">\n                    <input\n                        type=\"text\"\n                        value={newCriterion}\n                        onChange={(e) => setNewCriterion(e.target.value)}\n                        onKeyPress={(e) => e.key === 'Enter' && addCriterion()}\n                        placeholder=\"New criterion name\"\n                        className=\"flex-grow p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none\"\n                    />\n                    <button onClick={addCriterion} className=\"text-green-500 hover:text-green-600 transition-colors transform hover:scale-125\">\n                        {plusIcon}\n                    </button>\n                </div>\n                {renderList(criteria, 'CRITERIA')}\n            </div>\n            <div>\n                <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">Options (Alternatives)</h3>\n                <div className=\"flex gap-2\">\n                    <input\n                        type=\"text\"\n                        value={newOption}\n                        onChange={(e) => setNewOption(e.target.value)}\n                        onKeyPress={(e) => e.key === 'Enter' && addOption()}\n                        placeholder=\"New option name\"\n                        className=\"flex-grow p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none\"\n                    />\n                    <button onClick={addOption} className=\"text-green-500 hover:text-green-600 transition-colors transform hover:scale-125\">\n                        {plusIcon}\n                    </button>\n                </div>\n                {renderList(options, 'OPTIONS')}\n            </div>\n        </div>\n    </Card>\n  );\n};\n\nconst getIntensityDescription = (value) => {\n    const intValue = Math.round(value);\n    switch (intValue) {\n        case 1: return \"Equal Importance: Two factors contribute equally to the objective.\";\n        case 2: return \"Intermediate Importance between 1 and 3.\";\n        case 3: return \"Somewhat More Important: Experience and judgment slightly favor one over the other.\";\n        case 4: return \"Intermediate Importance between 3 and 5.\";\n        case 5: return \"Much More Important: Experience and judgment strongly favor one over the other.\";\n        case 6: return \"Intermediate Importance between 5 and 7.\";\n        case 7: return \"Very Much More Important: A factor is favored very strongly over the other.\";\n        case 8: return \"Intermediate Importance between 7 and 9.\";\n        case 9: return \"Extremely More Important: The evidence favoring one factor over another is of the highest possible validity.\";\n        default: return \"\";\n    }\n};\n\nconst ComparisonSlider = ({ crit1, crit2, value, onChange }) => {\n    // Convert matrix value to slider position (-8 to 8)\n    // Negative slider value means crit1 is more important\n    // Positive slider value means crit2 is more important\n    const sliderValue = value >= 1 ? -(value - 1) : (1 / value - 1);\n\n    const handleSliderChange = (e) => {\n        const newSliderValue = parseFloat(e.target.value);\n        let newMatrixValue;\n        if (newSliderValue <= 0) { // Left side -> crit1 is more important\n            newMatrixValue = -newSliderValue + 1;\n        } else { // Right side -> crit2 is more important\n            newMatrixValue = 1 / (newSliderValue + 1);\n        }\n        onChange(newMatrixValue);\n    };\n\n    let preferenceText;\n    let intensityValue;\n\n    if (value > 1) {\n        preferenceText = `${crit1} is ${Math.round(value)}x more important than ${crit2}`;\n        intensityValue = value;\n    } else if (value < 1) {\n        const inverseValue = 1 / value;\n        preferenceText = `${crit2} is ${Math.round(inverseValue)}x more important than ${crit1}`;\n        intensityValue = inverseValue;\n    } else {\n        preferenceText = \"Both criteria are equally important\";\n        intensityValue = 1;\n    }\n\n    return (\n        <div className=\"p-4 bg-gray-50 rounded-lg\">\n            <div className=\"flex justify-between items-center mb-2 font-semibold text-gray-700\">\n                <span>{crit1}</span>\n                <span>{crit2}</span>\n            </div>\n            <input\n                type=\"range\"\n                min=\"-8\"\n                max=\"8\"\n                step=\"1\"\n                value={sliderValue}\n                onChange={handleSliderChange}\n                className=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer\"\n            />\n            <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\n                <span>More important</span>\n                <span>More important</span>\n            </div>\n            <div className=\"text-center mt-3 p-2 bg-white rounded-md shadow-inner\">\n                <p className=\"font-semibold text-blue-700\">{preferenceText}</p>\n                <p className=\"text-sm text-gray-600\">{getIntensityDescription(intensityValue)}</p>\n            </div>\n        </div>\n    );\n};\n\n\nconst Step2 = ({ criteria, pairwiseMatrix, onMatrixChange, weights, consistency }) => {\n    const handleComparisonChange = (i, j, newValue) => {\n        const newMatrix = pairwiseMatrix.map(r => r.slice());\n        newMatrix[i][j] = newValue;\n        newMatrix[j][i] = 1 / newValue;\n        onMatrixChange(newMatrix);\n    };\n\n    return (\n        <Card title=\"Step 2: Pairwise Comparison of Criteria\">\n            <div className=\"bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 mb-6\" role=\"alert\">\n              <p className=\"font-bold\">How this works:</p>\n              <p>For each pair of criteria, move the slider to indicate which is more important and by how much. The scale ranges from 1 (equally important) to 9 (extremely more important). Your judgments will be used to calculate the weight, or overall importance, of each criterion.</p>\n            </div>\n            <div className=\"space-y-4\">\n                {criteria.map((crit1, i) =>\n                    criteria.map((crit2, j) => {\n                        if (i < j) {\n                            return (\n                                <ComparisonSlider\n                                    key={`${i}-${j}`}\n                                    crit1={crit1.content}\n                                    crit2={crit2.content}\n                                    value={pairwiseMatrix[i]?.[j] || 1}\n                                    onChange={(newValue) => handleComparisonChange(i, j, newValue)}\n                                />\n                            );\n                        }\n                        return null;\n                    })\n                )}\n            </div>\n             {weights.length > 0 && (\n                <div className=\"mt-6 p-4 bg-blue-50 rounded-lg\">\n                    <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">Results</h3>\n                    <div className=\"grid md:grid-cols-2 gap-4\">\n                        <div>\n                            <h4 className=\"font-bold\">Relative Importance (Weights)</h4>\n                            <ul className=\"list-disc list-inside\">\n                                {criteria.map((criterion, index) => (\n                                    <li key={criterion.id}>{criterion.content}: <span className=\"font-mono\">{(weights[index] * 100).toFixed(2)}%</span></li>\n                                ))}\n                            </ul>\n                        </div>\n                        <div>\n                            <h4 className=\"font-bold\">Consistency Check</h4>\n                            <p>Consistency Ratio (CR): <span className={`font-mono font-bold ${consistency.isConsistent ? 'text-green-600' : 'text-red-600'}`}>{consistency.cr.toFixed(4)}</span></p>\n                            <p className={`text-sm ${consistency.isConsistent ? 'text-green-700' : 'text-red-700'}`}>\n                                {consistency.isConsistent ? 'Judgments are consistent (CR < 0.1)' : 'Inconsistent judgments (CR >= 0.1). Please review your comparisons.'}\n                            </p>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </Card>\n    );\n};\n\nconst UtilityChart = ({ utilityFunction }) => {\n    const chartData = useMemo(() => {\n        const points = utilityFunction.points?.slice().sort((a, b) => a.x - b.x) || [];\n        \n        let labels, data;\n\n        if (utilityFunction.criterionType === 'quantitative' && utilityFunction.mode === 'formula' && utilityFunction.formulaString) {\n            const minX = points.length > 0 ? points[0].x : 0;\n            const maxX = points.length > 0 ? points[points.length - 1].x : 100;\n            const range = maxX - minX;\n            \n            labels = Array.from({length: 11}, (_, i) => minX + i * (range / 10));\n            data = labels.map(x => safeEval(utilityFunction.formulaString, x));\n        } else if (utilityFunction.criterionType === 'quantitative') {\n            labels = points.map(p => p.x);\n            data = points.map(p => p.y);\n        } else { // Qualitative\n            labels = utilityFunction.qualitativeLevels.map(l => l.label);\n            data = utilityFunction.qualitativeLevels.map(l => l.utility);\n        }\n\n        return {\n            labels,\n            datasets: [{\n                label: 'Utility',\n                data,\n                borderColor: 'rgb(75, 192, 192)',\n                backgroundColor: 'rgba(75, 192, 192, 0.5)',\n                tension: 0.1,\n            }]\n        };\n    }, [utilityFunction]);\n\n    const chartOptions = {\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: { legend: { display: false } },\n        scales: {\n            x: { type: utilityFunction.criterionType === 'quantitative' ? 'linear' : 'category', title: { display: true, text: 'Criterion Value / Label' } },\n            y: { title: { display: true, text: 'Utility' }, min: 0, max: 100 }\n        }\n    };\n\n    return (\n        <div className=\"relative h-64 mt-4\">\n            {utilityFunction.criterionType === 'quantitative' ? (\n                <Line data={chartData} options={chartOptions} />\n            ) : (\n                <Bar data={chartData} options={chartOptions} />\n            )}\n        </div>\n    );\n};\n\nconst Step3 = ({ criteria, utilityFunctions, setUtilityFunctions }) => {\n    \n    const setFunctionData = (criterionId, data) => {\n        setUtilityFunctions(prev => ({\n            ...prev,\n            [criterionId]: { ...prev[criterionId], ...data }\n        }));\n    };\n\n    const addPoint = (criterionId) => {\n        const newPoints = [...utilityFunctions[criterionId].points, { x: 0, y: 0 }];\n        setFunctionData(criterionId, { points: newPoints });\n    };\n    \n    const addQualitativeLevel = (criterionId) => {\n        const newLevels = [...utilityFunctions[criterionId].qualitativeLevels, { label: 'New Level', utility: 50 }];\n        setFunctionData(criterionId, { qualitativeLevels: newLevels });\n    };\n\n    const updatePoint = (criterionId, index, field, value) => {\n        const newPoints = [...utilityFunctions[criterionId].points];\n        newPoints[index][field] = parseFloat(value) || 0;\n        setFunctionData(criterionId, { points: newPoints });\n    };\n    \n    const updateQualitativeLevel = (criterionId, index, field, value) => {\n        const newLevels = [...utilityFunctions[criterionId].qualitativeLevels];\n        newLevels[index][field] = field === 'utility' ? (parseFloat(value) || 0) : value;\n        setFunctionData(criterionId, { qualitativeLevels: newLevels });\n    };\n    \n    const removePoint = (criterionId, index) => {\n        const newPoints = [...utilityFunctions[criterionId].points];\n        newPoints.splice(index, 1);\n        setFunctionData(criterionId, { points: newPoints });\n    }\n    \n    const removeQualitativeLevel = (criterionId, index) => {\n        const newLevels = [...utilityFunctions[criterionId].qualitativeLevels];\n        newLevels.splice(index, 1);\n        setFunctionData(criterionId, { qualitativeLevels: newLevels });\n    }\n\n    const TabButton = ({ text, active, onClick }) => (\n        <button\n            onClick={onClick}\n            className={`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${\n                active ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-600 hover:bg-gray-300'\n            }`}\n        >\n            {text}\n        </button>\n    );\n\n    return (\n        <Card title=\"Step 3: Define Utility Functions\">\n            <div className=\"space-y-8\">\n                {criteria.map(criterion => {\n                    const funcData = utilityFunctions[criterion.id];\n                    if (!funcData) return null; // FIX: Prevent crash on new criterion\n                    \n                    return (\n                        <div key={criterion.id} className=\"p-4 bg-gray-50 rounded-lg\">\n                            <div className=\"flex justify-between items-center mb-3\">\n                                <h3 className=\"text-xl font-semibold text-gray-800\">{criterion.content}</h3>\n                                <select\n                                    value={funcData.criterionType}\n                                    onChange={(e) => setFunctionData(criterion.id, { criterionType: e.target.value })}\n                                    className=\"p-2 border rounded-lg\"\n                                >\n                                    <option value=\"quantitative\">Quantitative</option>\n                                    <option value=\"qualitative\">Qualitative</option>\n                                </select>\n                            </div>\n                            \n                            {funcData.criterionType === 'quantitative' ? (\n                            <>\n                                <div className=\"border-b border-gray-300\">\n                                    <TabButton text=\"Formula\" active={funcData.mode === 'formula'} onClick={() => setFunctionData(criterion.id, { mode: 'formula' })} />\n                                    <TabButton text=\"Table\" active={funcData.mode === 'table'} onClick={() => setFunctionData(criterion.id, { mode: 'table' })} />\n                                </div>\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4\">\n                                    <div>\n                                        {funcData.mode === 'formula' && (\n                                            <div>\n                                                <label className=\"block text-sm font-medium text-gray-700\">Formula (e.g., 100 - x/1000)</label>\n                                                <input type=\"text\" placeholder=\"Enter formula with 'x'\" value={funcData.formulaString} onChange={(e) => setFunctionData(criterion.id, { formulaString: e.target.value })} className=\"w-full p-2 border rounded-lg mt-1\"/>\n                                            </div>\n                                        )}\n                                        {funcData.mode === 'table' && (\n                                            <div>\n                                                <label className=\"block text-sm font-medium text-gray-700\">Define with Points</label>\n                                                <div className=\"space-y-2 mt-1 max-h-48 overflow-y-auto pr-2\">\n                                                    {funcData.points.map((point, index) => (\n                                                        <div key={index} className=\"flex items-center gap-2\">\n                                                            <input type=\"number\" value={point.x} onChange={(e) => updatePoint(criterion.id, index, 'x', e.target.value)} className=\"w-full p-1 border rounded-md\" placeholder=\"Value\"/>\n                                                            <span>→</span>\n                                                            <input type=\"number\" value={point.y} onChange={(e) => updatePoint(criterion.id, index, 'y', e.target.value)} className=\"w-full p-1 border rounded-md\" placeholder=\"Utility\"/>\n                                                            <button onClick={() => removePoint(criterion.id, index)} className=\"text-red-500 hover:text-red-700\">X</button>\n                                                        </div>\n                                                    ))}\n                                                </div>\n                                                <button onClick={() => addPoint(criterion.id)} className=\"mt-2 text-sm bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600\">Add Point</button>\n                                            </div>\n                                        )}\n                                    </div>\n                                    <div><UtilityChart utilityFunction={funcData} /></div>\n                                </div>\n                            </>\n                            ) : (\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 pt-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700\">Define Qualitative Levels</label>\n                                    <div className=\"space-y-2 mt-1 max-h-48 overflow-y-auto pr-2\">\n                                        {funcData.qualitativeLevels.map((level, index) => (\n                                            <div key={index} className=\"flex items-center gap-2\">\n                                                <input type=\"text\" value={level.label} onChange={(e) => updateQualitativeLevel(criterion.id, index, 'label', e.target.value)} className=\"w-full p-1 border rounded-md\" placeholder=\"Label (e.g., High)\"/>\n                                                <span>→</span>\n                                                <input type=\"number\" value={level.utility} onChange={(e) => updateQualitativeLevel(criterion.id, index, 'utility', e.target.value)} className=\"w-full p-1 border rounded-md\" placeholder=\"Utility\"/>\n                                                <button onClick={() => removeQualitativeLevel(criterion.id, index)} className=\"text-red-500 hover:text-red-700\">X</button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                    <button onClick={() => addQualitativeLevel(criterion.id)} className=\"mt-2 text-sm bg-blue-500 text-white px-3 py-1 rounded-md hover:bg-blue-600\">Add Level</button>\n                                </div>\n                                <div><UtilityChart utilityFunction={funcData} /></div>\n                            </div>\n                            )}\n                        </div>\n                    );\n                })}\n            </div>\n        </Card>\n    );\n};\n\n\nconst Step4 = ({ options, criteria, optionValues, setOptionValues, utilityFunctions, utilityScores, setUtilityScores }) => {\n    const handleValueChange = (optionId, criterionId, value) => {\n        setOptionValues(prev => ({\n            ...prev,\n            [optionId]: { ...prev[optionId], [criterionId]: value }\n        }));\n    };\n\n    const calculateScores = useCallback(() => {\n        const newUtilityScores = {};\n        options.forEach(option => {\n            newUtilityScores[option.id] = {};\n            criteria.forEach(criterion => {\n                const func = utilityFunctions[criterion.id];\n                let utility = 0;\n\n                if (func) {\n                    if (func.criterionType === 'qualitative') {\n                        const selectedLabel = optionValues[option.id]?.[criterion.id];\n                        const level = func.qualitativeLevels.find(l => l.label === selectedLabel);\n                        if (level) {\n                            utility = level.utility;\n                        }\n                    } else {\n                        const value = parseFloat(optionValues[option.id]?.[criterion.id]);\n                        if (!isNaN(value)) {\n                            if (func.mode === 'formula' && func.formulaString) {\n                                const result = safeEval(func.formulaString, value);\n                                if (result !== null) utility = result;\n                            } else if (func.mode === 'table' && func.points && func.points.length > 0) {\n                                utility = interpolate(value, func.points);\n                            }\n                        }\n                    }\n                }\n                newUtilityScores[option.id][criterion.id] = Math.max(0, Math.min(100, utility));\n            });\n        });\n        setUtilityScores(newUtilityScores);\n    }, [options, criteria, optionValues, utilityFunctions, setUtilityScores]);\n\n\n    useEffect(() => {\n        calculateScores();\n    }, [calculateScores]);\n\n    return (\n        <Card title=\"Step 4: Evaluate Alternatives & Calculate Utility\">\n            <p className=\"text-sm text-gray-600 mb-4\">Enter the value for each option against each criterion. For qualitative criteria, select the appropriate level from the dropdown.</p>\n            <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-left border-collapse\">\n                    <thead>\n                        <tr>\n                            <th className=\"p-3 bg-gray-100 font-semibold text-gray-700 border-b-2 border-gray-200\">Option</th>\n                            {criteria.map(c => <th key={c.id} className=\"p-3 bg-gray-100 font-semibold text-gray-700 border-b-2 border-gray-200\">{c.content}</th>)}\n                        </tr>\n                    </thead>\n                    <tbody>\n                        {options.map(option => (\n                            <tr key={option.id} className=\"hover:bg-gray-50\">\n                                <td className=\"p-3 border-b border-gray-200 font-semibold\">{option.content}</td>\n                                {criteria.map(criterion => (\n                                    <td key={criterion.id} className=\"p-2 border-b border-gray-200\">\n                                        {utilityFunctions[criterion.id]?.criterionType === 'qualitative' ? (\n                                            <select\n                                                value={optionValues[option.id]?.[criterion.id] || ''}\n                                                onChange={(e) => handleValueChange(option.id, criterion.id, e.target.value)}\n                                                className=\"w-full p-1 border rounded-md mb-1\"\n                                            >\n                                                <option value=\"\">Select Level</option>\n                                                {utilityFunctions[criterion.id].qualitativeLevels.map(level => (\n                                                    <option key={level.label} value={level.label}>{level.label}</option>\n                                                ))}\n                                            </select>\n                                        ) : (\n                                            <input\n                                                type=\"number\"\n                                                value={optionValues[option.id]?.[criterion.id] || ''}\n                                                onChange={(e) => handleValueChange(option.id, criterion.id, e.target.value)}\n                                                className=\"w-full p-1 border rounded-md mb-1\"\n                                            />\n                                        )}\n                                        <div className=\"text-right text-xs text-gray-400\">\n                                            Utility: {(utilityScores[option.id]?.[criterion.id] || 0).toFixed(0)}\n                                        </div>\n                                    </td>\n                                ))}\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </div>\n        </Card>\n    );\n};\n\nconst Step5 = ({ onGenerateReport, ...props }) => {\n    const { objective, options, criteria, weights, utilityScores } = props;\n\n    const finalScores = useMemo(() => {\n        const scores = {};\n        options.forEach(option => {\n            let totalScore = 0;\n            criteria.forEach((criterion, index) => {\n                const utility = utilityScores[option.id]?.[criterion.id] || 0;\n                const weight = weights[index] || 0;\n                totalScore += utility * weight;\n            });\n            scores[option.id] = totalScore;\n        });\n        return scores;\n    }, [options, criteria, weights, utilityScores]);\n\n    const sortedOptions = useMemo(() => \n        options.map(o => ({...o, score: finalScores[o.id] || 0})).sort((a, b) => b.score - a.score),\n        [options, finalScores]\n    );\n    \n    const chartData = {\n        labels: sortedOptions.map(o => o.content),\n        datasets: [\n            {\n                label: 'Final Scores',\n                data: sortedOptions.map(o => o.score),\n                backgroundColor: 'rgba(54, 162, 235, 0.6)',\n                borderColor: 'rgba(54, 162, 235, 1)',\n                borderWidth: 1,\n            },\n        ],\n    };\n    \n    const chartOptions = {\n        indexAxis: 'y',\n        responsive: true,\n        maintainAspectRatio: false,\n        plugins: {\n            legend: {\n                display: false,\n            },\n            title: {\n                display: true,\n                text: 'Final Decision Ranking',\n                font: { size: 18 }\n            },\n        },\n        scales: {\n            x: {\n                beginAtZero: true,\n                title: {\n                    display: true,\n                    text: 'Total Weighted Score'\n                }\n            }\n        }\n    };\n\n    return (\n        <Card title=\"Step 5: View Results & Export Report\">\n            <div className=\"mb-4\">\n                <h3 className=\"text-xl font-semibold text-gray-700\">Decision Objective</h3>\n                <p className=\"text-gray-600 mt-1\">{objective}</p>\n            </div>\n            <div className=\"grid md:grid-cols-2 gap-8 items-center\">\n                <div>\n                    <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">Final Ranking</h3>\n                    <ol className=\"list-decimal list-inside space-y-2\">\n                        {sortedOptions.map((option, index) => (\n                            <li key={option.id} className={`p-3 rounded-lg ${index === 0 ? 'bg-green-100 text-green-800 font-bold' : 'bg-gray-100'}`}>\n                                <span className=\"mr-2\">{option.content}:</span>\n                                <span className=\"font-mono\">{option.score.toFixed(2)}</span>\n                            </li>\n                        ))}\n                    </ol>\n                    <button onClick={onGenerateReport} className=\"mt-6 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors w-full flex items-center justify-center gap-2 text-lg\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z\" />\n                        </svg>\n                        Generate Report\n                    </button>\n                </div>\n                <div className=\"relative h-96\">\n                    <Bar data={chartData} options={chartOptions} />\n                </div>\n            </div>\n        </Card>\n    );\n};\n\nconst ReportPage = ({ data, onBack }) => {\n    useEffect(() => {\n        if (!data) {\n            onBack();\n            return;\n        }\n        const { objective, sortedOptions, criteria, weights, consistency, pairwiseMatrix, utilityFunctions, optionValues } = data;\n        const reportWindow = window.open('', '_blank');\n        if (reportWindow) {\n            const resultsTable = sortedOptions.map((opt, index) => `\n                <tr class=\"hover:bg-gray-50\">\n                    <td class=\"p-3 border\">${index + 1}</td>\n                    <td class=\"p-3 border font-semibold\">${opt.content}</td>\n                    <td class=\"p-3 border font-mono\">${opt.score.toFixed(2)}</td>\n                </tr>\n            `).join('');\n\n            const weightsTable = criteria.map((crit, index) => `\n                <tr class=\"hover:bg-gray-50\">\n                    <td class=\"p-3 border\">${crit.content}</td>\n                    <td class=\"p-3 border font-mono\">${(weights[index] * 100).toFixed(2)}%</td>\n                </tr>\n            `).join('');\n            \n            const simplifiedPairwise = criteria.map((crit1, i) => {\n                return criteria.map((crit2, j) => {\n                    if (i >= j) return null;\n                    const value = pairwiseMatrix[i][j];\n                    let intensity;\n                    if (value >= 1) {\n                        intensity = ((value - 1) / 8) * 50;\n                        return `<div class=\"flex items-center justify-between p-2\"><span class=\"w-1/3 text-right\">${crit1.content}</span><div class=\"w-1/3 mx-2 h-2 bg-gray-200 rounded-full\"><div class=\"h-2 bg-blue-500 rounded-l-full\" style=\"width:${intensity}%; margin-left:${50-intensity}%\"></div></div><span class=\"w-1/3 text-left\">${crit2.content}</span></div>`;\n                    } else {\n                        const inv = 1 / value;\n                        intensity = ((inv - 1) / 8) * 50;\n                        return `<div class=\"flex items-center justify-between p-2\"><span class=\"w-1/3 text-right\">${crit1.content}</span><div class=\"w-1/3 mx-2 h-2 bg-gray-200 rounded-full\"><div class=\"h-2 bg-blue-500 rounded-r-full\" style=\"width:${intensity}%; margin-left:50%\"></div></div><span class=\"w-1/3 text-left\">${crit2.content}</span></div>`;\n                    }\n                }).filter(Boolean).join('');\n            }).join('');\n\n            const utilityAppendix = criteria.map(crit => {\n                const func = utilityFunctions[crit.id];\n                let content;\n                if (func.criterionType === 'qualitative') {\n                    const levels = func.qualitativeLevels.map(l => `<li>${l.label}: ${l.utility}</li>`).join('');\n                    content = `<ul>${levels}</ul>`;\n                } else if (func.mode === 'formula') {\n                    content = `<p class=\"font-mono bg-gray-100 p-2 rounded\">f(x) = ${func.formulaString}</p>`;\n                } else {\n                    const points = func.points.map(p => `<li>Value ${p.x} → Utility ${p.y}</li>`).join('');\n                    content = `<ul>${points}</ul>`;\n                }\n                return `<div class=\"mb-4\"><h4 class=\"font-semibold\">${crit.content} (${func.criterionType})</h4>${content}</div>`;\n            }).join('');\n\n            const evaluationsHeader = criteria.map(c => `<th class=\"p-2 border\">${c.content}</th>`).join('');\n            const evaluationsBody = data.options.map(option => `\n                <tr>\n                    <th class=\"p-2 border bg-gray-100\">${option.content}</th>\n                    ${criteria.map(criterion => `<td class=\"p-2 border text-center font-mono\">${optionValues[option.id]?.[criterion.id] || 'N/A'}</td>`).join('')}\n                </tr>\n            `).join('');\n\n            reportWindow.document.write(`\n                <!DOCTYPE html>\n                <html lang=\"en\">\n                <head>\n                    <meta charset=\"UTF-8\">\n                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n                    <title>AHP Analysis Report</title>\n                    <script src=\"https://cdn.tailwindcss.com\"></script>\n                    <style>\n                        @media print { .no-print { display: none; } body { -webkit-print-color-adjust: exact; } }\n                        section { page-break-inside: avoid; }\n                    </style>\n                </head>\n                <body class=\"bg-white p-8 md:p-12 font-sans\">\n                    <div class=\"no-print mb-8 text-center flex justify-center gap-4\">\n                        <button onclick=\"window.close()\" class=\"bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors\">\n                            ← Close Report\n                        </button>\n                        <button onclick=\"window.print()\" class=\"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors\">\n                            Print or Save as PDF\n                        </button>\n                    </div>\n                    <div class=\"max-w-4xl mx-auto\">\n                        <header class=\"text-center border-b-2 pb-4 mb-8\">\n                            <h1 class=\"text-4xl font-bold text-gray-800\">Decision Analysis Report</h1>\n                            <p class=\"text-lg text-gray-600 mt-2\">Analytic Hierarchy Process (AHP)</p>\n                        </header>\n                        <section class=\"mb-10\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">1. About This Report</h2>\n                            <p class=\"text-gray-700 mb-2\">This report uses the Analytic Hierarchy Process (AHP) to break down a complex decision into a structured system of goals, criteria, and alternatives. This allows for a systematic and rational evaluation. For more details on the methodology, see the <a href=\"https://www.burgehugheswalsh.co.uk/Uploaded/1/Documents/Analytic-Hierarchy-Process-Tool-v2.pdf\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"text-blue-600 hover:underline\">AHP explanation document</a>.</p>\n                        </section>\n                        <section class=\"mb-10\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">2. Executive Summary</h2>\n                            <p class=\"text-lg text-gray-700 mb-2\"><strong>Decision Goal:</strong> ${objective}</p>\n                            <div class=\"bg-green-100 border-l-4 border-green-500 text-green-800 p-4 rounded-r-lg\">\n                                <p class=\"font-bold text-xl\">Recommendation: ${sortedOptions[0]?.content || 'N/A'}</p>\n                                <p>Based on the criteria and weightings provided, the recommended option is <strong>${sortedOptions[0]?.content || 'N/A'}</strong> with a final score of <strong>${sortedOptions[0]?.score.toFixed(2) || '0.00'}</strong>.</p>\n                            </div>\n                        </section>\n                        <section class=\"mb-10\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">3. Final Results</h2>\n                            <table class=\"w-full text-left border-collapse\">\n                                <thead class=\"bg-gray-100\"><tr><th class=\"p-3 border\">Rank</th><th class=\"p-3 border\">Option</th><th class=\"p-3 border\">Final Score</th></tr></thead>\n                                <tbody>${resultsTable}</tbody>\n                            </table>\n                        </section>\n                        <section class=\"mb-10\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">4. Criteria Weights & Consistency</h2>\n                            <p class=\"text-gray-600 mb-4\">The following weights were determined by comparing the relative importance of each criterion. The Consistency Ratio (CR) checks for contradictions in the judgments; a value below 0.10 is considered acceptable.</p>\n                            <div class=\"grid md:grid-cols-2 gap-8\">\n                                <table class=\"w-full text-left border-collapse\">\n                                    <thead class=\"bg-gray-100\"><tr><th class=\"p-3 border\">Criterion</th><th class=\"p-3 border\">Weight</th></tr></thead>\n                                    <tbody>${weightsTable}</tbody>\n                                </table>\n                                <div class=\"p-4 bg-gray-100 rounded-lg\">\n                                    <h4 class=\"font-bold text-lg\">Consistency Check</h4>\n                                    <p class=\"text-2xl font-mono ${consistency.isConsistent ? 'text-green-600' : 'text-red-600'}\">${consistency.cr.toFixed(4)}</p>\n                                    <p>${consistency.isConsistent ? 'Judgments are consistent.' : 'Judgments are inconsistent.'}</p>\n                                </div>\n                            </div>\n                        </section>\n                        <section class=\"mb-10\" style=\"page-break-before: always;\">\n                            <h2 class=\"text-2xl font-semibold text-gray-700 border-b pb-2 mb-4\">5. Appendix</h2>\n                            <h3 class=\"text-xl font-semibold text-gray-700 mt-6 mb-2\">A. Simplified Pairwise Comparisons</h3>\n                            <div class=\"space-y-2\">${simplifiedPairwise}</div>\n                            <h3 class=\"text-xl font-semibold text-gray-700 mt-8 mb-2\">B. Utility Functions</h3>\n                            <div class=\"p-4 border rounded-lg\">${utilityAppendix}</div>\n                            <h3 class=\"text-xl font-semibold text-gray-700 mt-8 mb-2\">C. Option Evaluations</h3>\n                            <table class=\"w-full text-left border-collapse text-sm\">\n                                <thead class=\"bg-gray-100\"><tr><th class=\"p-2 border\">Option</th>${evaluationsHeader}</tr></thead>\n                                <tbody>${evaluationsBody}</tbody>\n                            </table>\n                        </section>\n                    </div>\n                </body>\n                </html>\n            `);\n            reportWindow.document.close();\n        }\n    }, [data, onBack]);\n\n    if (!data) {\n        return <div className=\"p-8\">Loading report data...</div>;\n    }\n\n    return null; // This component now only handles opening the report\n};\n\nfunction App() {\n    const [objective, setObjective] = useState(\"Choose the best car for a family\");\n  \n    const [criteria, setCriteria] = useState([\n        { id: 'Risk', content: 'Risk' },\n        { id: 'SW Effort/Schedule', content: 'SW Effort/Schedule' },\n        { id: 'HW Costs', content: 'HW Costs' },\n        { id: 'Future Adaptability', content: 'Future Adaptability' }\n    ]);\n    \n    const [options, setOptions] = useState([\n        { id: 'Dual Primary', content: 'Dual Primary' },\n        { id: 'Compressed Dual Primary', content: 'Compressed Dual Primary' },\n        { id: 'Compressed Asymmetric Primary', content: 'Compressed Asymmetric Primary' },\n        { id: 'Tele-assisted Secondary', content: 'Tele-assisted Secondary' }\n    ]);\n    \n    const [pairwiseMatrix, setPairwiseMatrix] = useState([\n      [1, 9, 7, 7],\n      [1/9, 1, 3, 1/3],\n      [1/7, 1/3, 1, 5],\n      [1/7, 3, 1/5, 1]\n    ]);\n    \n    const [weights, setWeights] = useState([]);\n    const [consistency, setConsistency] = useState({ cr: 0, isConsistent: true });\n    \n    const [utilityFunctions, setUtilityFunctions] = useState({\n        'Risk': { criterionType: 'qualitative', mode: 'table', formulaString: '', points: [], qualitativeLevels: [{label: 'Low', utility: 100}, {label: 'Medium', utility: 50}, {label: 'High', utility: 0}] },\n        'SW Effort/Schedule': { criterionType: 'quantitative', mode: 'table', formulaString: '', points: [{x: 0, y: 0}, {x: 100, y: 100}], qualitativeLevels: [] },\n        'HW Costs': { criterionType: 'quantitative', mode: 'formula', formulaString: '100 * (400000 - x) / (400000 - 300000)', points: [{x: 300000, y: 100}, {x: 400000, y: 0}], qualitativeLevels: [] },\n        'Future Adaptability': { criterionType: 'quantitative', mode: 'table', formulaString: '', points: [{x: 0, y: 0}, {x: 100, y: 100}], qualitativeLevels: [] }\n    });\n    \n    const [optionValues, setOptionValues] = useState({});\n    const [view, setView] = useState('main'); // 'main' or 'report'\n\n    const finalScores = useMemo(() => {\n        if (criteria.length === 0 || options.length === 0) return [];\n        try {\n            const normalizedMatrix = normalizeMatrix(pairwiseMatrix);\n            const weights = calculateWeights(normalizedMatrix);\n            const calculatedOptionValues = calculateOptionValues(options, criteria, utilityFunctions);\n            const scores = calculateFinalScores(options, criteria, weights, calculatedOptionValues);\n            return scores;\n        } catch (error) {\n            console.error(\"Error calculating final scores:\", error);\n            return [];\n        }\n    }, [criteria, options, pairwiseMatrix, utilityFunctions]);\n\n    const sortedOptions = useMemo(() => {\n        if (finalScores.length === 0) return [];\n        const enrichedOptions = options.map(opt => ({\n            ...opt,\n            score: finalScores.find(s => s.optionId === opt.id)?.score || 0\n        }));\n        return enrichedOptions.sort((a, b) => b.score - a.score);\n    }, [options, finalScores]);\n\n    const handleSave = () => {\n        const dataStr = JSON.stringify({ objective, criteria, options, pairwiseMatrix, utilityFunctions, optionValues });\n        const blob = new Blob([dataStr], { type: \"application/json\" });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement(\"a\");\n        a.href = url;\n        a.download = \"ahp_data.json\";\n        a.click();\n        URL.revokeObjectURL(url);\n    };\n\n    const handleLoad = (event) => {\n        const file = event.target.files[0];\n        if (!file) return;\n        const reader = new FileReader();\n        reader.onload = (e) => {\n            try {\n                const data = JSON.parse(e.target.result);\n                setObjective(data.objective);\n                setCriteria(data.criteria);\n                setOptions(data.options);\n                setPairwiseMatrix(data.pairwiseMatrix);\n                setUtilityFunctions(data.utilityFunctions);\n                setOptionValues(data.optionValues);\n            } catch (error) {\n                console.error(\"Error loading file:\", error);\n            }\n        };\n        reader.readAsText(file);\n    };\n\n    if (view === 'report') {\n        const reportData = {\n            objective,\n            sortedOptions,\n            criteria,\n            weights: calculateWeights(normalizeMatrix(pairwiseMatrix)),\n            consistency: checkConsistency(pairwiseMatrix),\n            pairwiseMatrix,\n            utilityFunctions,\n            optionValues: calculateOptionValues(options, criteria, utilityFunctions),\n            options,\n        };\n        return <ReportPage data={reportData} onBack={() => setView('main')} />;\n    }\n\n    return (\n        <DndProvider backend={HTML5Backend}>\n        <div className=\"bg-gray-50 min-h-screen font-sans\">\n            <div className=\"bg-green-50 border-b-2 border-green-200 p-4\">\n                <header className=\"text-center\">\n                    <h1 className=\"text-4xl md:text-5xl font-extrabold text-green-800\">AHP Decision-Making Tool</h1>\n                    <p className=\"text-lg text-green-700 mt-2\">A structured approach to complex decision-making.</p>\n                </header>\n            </div>\n            <div className=\"container mx-auto p-4 md:p-8\">\n                <main>\n                    <Step1 objective={objective} setObjective={setObjective} criteria={criteria} setCriteria={setCriteria} options={options} setOptions={setOptions} />\n                    <Step2 criteria={criteria} pairwiseMatrix={pairwiseMatrix} onMatrixChange={handleMatrixChange} weights={weights} consistency={consistency} />\n                    <Step3 criteria={criteria} utilityFunctions={utilityFunctions} setUtilityFunctions={setUtilityFunctions} />\n                    <Step4 options={options} criteria={criteria} optionValues={optionValues} setOptionValues={setOptionValues} utilityFunctions={utilityFunctions} utilityScores={utilityScores} setUtilityScores={setUtilityScores} />\n                    \n                    {weights.length > 0 && Object.keys(utilityScores).length > 0 && (\n                      <Step5 \n                        objective={objective} \n                        options={options} \n                        criteria={criteria} \n                        weights={weights} \n                        consistency={consistency}\n                        utilityScores={utilityScores}\n                        pairwiseMatrix={pairwiseMatrix}\n                        utilityFunctions={utilityFunctions}\n                        optionValues={optionValues}\n                        onGenerateReport={handleGenerateReport}\n                      />\n                    )}\n                </main>\n            </div>\n        </div>\n        </DndProvider>\n    );\n}\n\nexport default App;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}